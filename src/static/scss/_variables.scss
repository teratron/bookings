@use "sass:math";
@use "sass:list";

$prefix:                "app-";

// Path
$fonts:                 "../fonts/";
$media:                 "../media/";
$js:                    "../js/";

// Root
$unit:                  1.25rem; // 20px
$px:                    .0625rem;
$rate_horizontal:       .8;
$rate_vertical:         .8;

// Grid
$grid_column:           12;
$grid_width:            $unit * 60; // 1200px
$grid_gap:              $unit * 2; // 40px
$grid_col_width:        math.div($grid_width, $grid_column);
$grid_cell_width:       math.div($grid_width - ($grid_column - 1) * $grid_gap, $grid_column);
$grid_cell_height:      $unit;

// Layout
$layout_gap:            $unit * 2; // 40px
$layout_gaps:           $layout_gap * 2;
$layout_width:          $grid_width + $layout_gaps;
$layout_width_min:      $unit * 18; // 360px
$layout_rate:           math.div(100vw, $layout_width);

// Z-index
$zindex_body:           1;
$zindex_app:            10;
$zindex_main:           20;
$zindex_content:        30;
$zindex_sidebar:        40;
$zindex_header:         50;
$zindex_footer:         60;
$zindex_dropdown:       1000;
$zindex_sticky:         2000;
$zindex_fixed:          3000;
$zindex_modal-backdrop: 4000;
$zindex_offcanvas:      5000;
$zindex_modal:          6000;
$zindex_popover:        7000;
$zindex_tooltip:        8000;
$zindex_debug:          10000;

// Breakpoints
@function getListBreakpoints() {
    $list: [];
    $b: math.div(100, $layout_width) * $layout_gaps;
    $g: 100 - $b;

    @for $i from 1 through $grid_column {
        $w: $i * $grid_col_width;
        $s: math.div($w, $g) * $b;
        $d: $w + $s - $px;
        $list: list.append($list, $d);
    }

    @return $list;
}

$list_breakpoints:      getListBreakpoints();

@function getBreakpoint($n: $grid_column) {
    @return list.nth($list_breakpoints, $n);
}

@mixin setPropsAdaptive($props) {
    @each $key, $value in $props {
        @if $value > 0 {
            #{$key}: $value;
        }
    }

    @media only screen and (max-width: getBreakpoint($grid_column)) {
        @each $key, $value in $props {
            @if $value > 0 {
                #{$key}: $layout_rate * $value;
            } @else {
                #{$key}: 0;
            }
        }
    }
}

@function stripUnit($value) {
    @return math.div($value, ($value * 0 + 1));
}

@function toRem($value) {
    @return 0.0625rem * stripUnit($value);
}


:root {
    /* Debug */
    --d1: #{$list_breakpoints};
    --d2: #{list.length($list_breakpoints)};
    --d3: #{list.nth($list_breakpoints, $grid_column)};
    --d4: #{getBreakpoint()};

    /* Theme */
    @include app-theme;
}
